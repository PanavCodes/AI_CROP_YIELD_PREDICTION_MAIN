<!DOCTYPE html>
<html>
<head>
    <title>Bhuvan LULC API Integration Test</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .container { max-width: 800px; margin: 0 auto; }
        .test-section { border: 1px solid #ddd; padding: 15px; margin: 10px 0; border-radius: 5px; }
        .result { background: #f5f5f5; padding: 10px; margin: 10px 0; border-radius: 3px; }
        .success { border-left: 4px solid #4CAF50; }
        .error { border-left: 4px solid #f44336; }
        button { padding: 10px 20px; margin: 5px; cursor: pointer; }
    </style>
</head>
<body>
    <div class="container">
        <h1>Bhuvan LULC API Integration Test</h1>
        
        <div class="test-section">
            <h2>Environment Variables Test</h2>
            <div id="env-test">Testing...</div>
        </div>
        
        <div class="test-section">
            <h2>LULC Service Test</h2>
            <button onclick="testLulcService()">Test Punjab Location (Agricultural)</button>
            <button onclick="testUrbanLocation()">Test Delhi Location (Urban)</button>
            <button onclick="testForestLocation()">Test Forest Location</button>
            <div id="lulc-results"></div>
        </div>
        
        <div class="test-section">
            <h2>Integrated Location Service Test</h2>
            <button onclick="testIntegratedService()">Test Integrated Service</button>
            <div id="integrated-results"></div>
        </div>
    </div>

    <script type="module">
        // Test environment variables
        function testEnvVars() {
            const lulcKey = import.meta.env.VITE_BHUVAN_LULC_API_KEY;
            const mapsKey = import.meta.env.VITE_GOOGLE_MAPS_API_KEY;
            
            const results = [];
            results.push(`LULC API Key: ${lulcKey ? '✅ Present' : '❌ Missing'}`);
            results.push(`Google Maps Key: ${mapsKey ? '✅ Present' : '❌ Missing'}`);
            
            document.getElementById('env-test').innerHTML = results.join('<br>');
        }
        
        // Test LULC service directly
        window.testLulcService = async function() {
            const resultsDiv = document.getElementById('lulc-results');
            resultsDiv.innerHTML = '<div>Testing Punjab agricultural area...</div>';
            
            try {
                // Simulate LULC service call (would normally import the service)
                const mockResult = {
                    success: true,
                    latitude: 30.7333,
                    longitude: 76.7794,
                    primary_class: {
                        class_name: 'Irrigated Cropland',
                        class_code: 1,
                        confidence: 88,
                        coverage_percent: 92,
                        agricultural_suitability: 'excellent',
                        crop_types: ['Rice', 'Wheat', 'Sugarcane', 'Cotton']
                    },
                    source: 'mock',
                    data_year: '2022-23'
                };
                
                resultsDiv.innerHTML = `
                    <div class="result success">
                        <h3>✅ LULC Classification Result</h3>
                        <p><strong>Location:</strong> ${mockResult.latitude}, ${mockResult.longitude}</p>
                        <p><strong>Land Use:</strong> ${mockResult.primary_class.class_name}</p>
                        <p><strong>Agricultural Suitability:</strong> ${mockResult.primary_class.agricultural_suitability}</p>
                        <p><strong>Confidence:</strong> ${mockResult.primary_class.confidence}%</p>
                        <p><strong>Suitable Crops:</strong> ${mockResult.primary_class.crop_types.join(', ')}</p>
                        <p><strong>Data Source:</strong> ${mockResult.source}</p>
                    </div>
                `;
            } catch (error) {
                resultsDiv.innerHTML = `<div class="result error">❌ Error: ${error.message}</div>`;
            }
        };
        
        window.testUrbanLocation = async function() {
            const resultsDiv = document.getElementById('lulc-results');
            resultsDiv.innerHTML = '<div>Testing Delhi urban area...</div>';
            
            const mockResult = {
                success: true,
                latitude: 28.6139,
                longitude: 77.2090,
                primary_class: {
                    class_name: 'Built-up Area',
                    class_code: 9,
                    confidence: 95,
                    coverage_percent: 87,
                    agricultural_suitability: 'unsuitable',
                    crop_types: []
                },
                source: 'mock',
                data_year: '2022-23'
            };
            
            resultsDiv.innerHTML = `
                <div class="result success">
                    <h3>✅ LULC Classification Result</h3>
                    <p><strong>Location:</strong> ${mockResult.latitude}, ${mockResult.longitude}</p>
                    <p><strong>Land Use:</strong> ${mockResult.primary_class.class_name}</p>
                    <p><strong>Agricultural Suitability:</strong> ${mockResult.primary_class.agricultural_suitability}</p>
                    <p><strong>Confidence:</strong> ${mockResult.primary_class.confidence}%</p>
                    <p><strong>Note:</strong> Urban area - not suitable for agriculture</p>
                </div>
            `;
        };
        
        window.testForestLocation = async function() {
            const resultsDiv = document.getElementById('lulc-results');
            resultsDiv.innerHTML = '<div>Testing forest area...</div>';
            
            const mockResult = {
                success: true,
                latitude: 15.3173,
                longitude: 75.7139,
                primary_class: {
                    class_name: 'Forest',
                    class_code: 5,
                    confidence: 91,
                    coverage_percent: 94,
                    agricultural_suitability: 'poor',
                    crop_types: []
                },
                source: 'mock',
                data_year: '2022-23'
            };
            
            resultsDiv.innerHTML = `
                <div class="result success">
                    <h3>✅ LULC Classification Result</h3>
                    <p><strong>Location:</strong> ${mockResult.latitude}, ${mockResult.longitude}</p>
                    <p><strong>Land Use:</strong> ${mockResult.primary_class.class_name}</p>
                    <p><strong>Agricultural Suitability:</strong> ${mockResult.primary_class.agricultural_suitability}</p>
                    <p><strong>Confidence:</strong> ${mockResult.primary_class.confidence}%</p>
                    <p><strong>Note:</strong> Forest area - limited agricultural potential</p>
                </div>
            `;
        };
        
        window.testIntegratedService = async function() {
            const resultsDiv = document.getElementById('integrated-results');
            resultsDiv.innerHTML = '<div>Testing integrated location service...</div>';
            
            // Mock integrated service result
            const mockIntegratedResult = {
                coordinates: { latitude: 30.7333, longitude: 76.7794 },
                administrative: {
                    village: 'Chandigarh',
                    district: 'Chandigarh',
                    state: 'Punjab',
                    source: 'bhuvan'
                },
                field: {
                    suggested_name: 'Chandigarh Field',
                    location_quality: 'excellent',
                    is_agricultural_area: true,
                    agricultural_suitability_score: 95
                },
                land_use: {
                    classification: {
                        success: true,
                        primary_class: {
                            class_name: 'Irrigated Cropland',
                            agricultural_suitability: 'excellent',
                            confidence: 88,
                            crop_types: ['Rice', 'Wheat', 'Cotton']
                        },
                        source: 'bhuvan_lulc'
                    },
                    suitability_score: 95,
                    recommendations: {
                        recommended: true,
                        reasons: ['Highly suitable for agriculture', 'Good soil and water conditions'],
                        suggestions: ['Maintain irrigation infrastructure', 'Consider water-efficient crops'],
                        crop_recommendations: ['Rice', 'Wheat', 'Cotton']
                    }
                },
                sources: ['bhuvan-backend', 'google-places', 'lulc-bhuvan_lulc'],
                timestamp: new Date().toISOString()
            };
            
            resultsDiv.innerHTML = `
                <div class="result success">
                    <h3>✅ Integrated Location Service Result</h3>
                    <p><strong>Field Name:</strong> ${mockIntegratedResult.field.suggested_name}</p>
                    <p><strong>Location Quality:</strong> ${mockIntegratedResult.field.location_quality}</p>
                    <p><strong>Administrative:</strong> ${mockIntegratedResult.administrative.village}, ${mockIntegratedResult.administrative.district}, ${mockIntegratedResult.administrative.state}</p>
                    <p><strong>Land Use:</strong> ${mockIntegratedResult.land_use.classification.primary_class.class_name}</p>
                    <p><strong>Agricultural Suitability:</strong> ${mockIntegratedResult.land_use.classification.primary_class.agricultural_suitability} (Score: ${mockIntegratedResult.field.agricultural_suitability_score}/100)</p>
                    <p><strong>Recommended Crops:</strong> ${mockIntegratedResult.land_use.recommendations.crop_recommendations.join(', ')}</p>
                    <p><strong>Data Sources:</strong> ${mockIntegratedResult.sources.join(', ')}</p>
                    <p><strong>Recommendations:</strong></p>
                    <ul>
                        ${mockIntegratedResult.land_use.recommendations.suggestions.map(s => `<li>${s}</li>`).join('')}
                    </ul>
                </div>
            `;
        };
        
        // Run environment test on load
        testEnvVars();
    </script>
</body>
</html>